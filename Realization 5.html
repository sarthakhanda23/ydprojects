<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streamliner | Realization Technologies</title>
    <style>
        /* -----------------------------------------------------------------------------
           1. CORE VARIABLES & RESET (Enterprise Slate/Blue Theme)
           ----------------------------------------------------------------------------- */
        :root {
            /* Palette */
            --primary: #0050b3; /* Deep Enterprise Blue */
            --primary-light: #1890ff;
            --primary-bg: #e6f7ff;
            
            --bg-body: #f0f2f5;
            --bg-sidebar: #001529; /* Dark Slate */
            --bg-sidebar-active: #1890ff;
            --bg-header: #ffffff;
            --bg-surface: #ffffff;

            --text-main: #262626;
            --text-secondary: #595959;
            --text-inverse: #ffffff;
            --text-muted: #8c8c8c;

            /* RAG Status Colors (Critical Chain) */
            --rag-red: #f5222d;
            --rag-red-bg: #fff1f0;
            --rag-amber: #fa8c16;
            --rag-amber-bg: #fff7e6;
            --rag-green: #52c41a;
            --rag-green-bg: #f6ffed;
            --rag-blue: #1890ff; /* Normal/Finished */
            --rag-grey: #d9d9d9;

            /* Layout Metrics */
            --sidebar-width: 240px;
            --header-height: 54px;
            --border-radius: 4px;
            --border-color: #d9d9d9;
            --shadow-card: 0 1px 2px 0 rgba(0,0,0,0.03), 0 1px 6px -1px rgba(0,0,0,0.02);
            
            /* Transitions */
            --anim-speed: 0.2s ease-in-out;
        }

        * { box-sizing: border-box; outline: none; }
        body { 
            margin: 0; padding: 0; 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            font-size: 13px; /* Compact enterprise font size */
            height: 100vh;
            overflow: hidden;
            display: flex;
        }

        /* -----------------------------------------------------------------------------
           2. UTILITY CLASSES
           ----------------------------------------------------------------------------- */
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .justify-end { justify-content: flex-end; }
        .grow { flex-grow: 1; }
        .gap-2 { gap: 8px; }
        .gap-4 { gap: 16px; }
        .p-2 { padding: 8px; }
        .p-4 { padding: 16px; }
        .m-0 { margin: 0; }
        .mb-2 { margin-bottom: 8px; }
        .mb-4 { margin-bottom: 16px; }
        .w-full { width: 100%; }
        .h-full { height: 100%; }
        .text-bold { font-weight: 600; }
        .text-right { text-align: right; }
        .text-center { text-align: center; }
        .cursor-pointer { cursor: pointer; }
        .hidden { display: none !important; }

        /* Status Badges */
        .badge { display: inline-block; padding: 2px 8px; border-radius: 10px; font-size: 11px; font-weight: 600; white-space: nowrap; }
        .badge.critical { background: var(--rag-red-bg); color: var(--rag-red); border: 1px solid var(--rag-red); }
        .badge.warning { background: var(--rag-amber-bg); color: var(--rag-amber); border: 1px solid var(--rag-amber); }
        .badge.ontrack { background: var(--rag-green-bg); color: var(--rag-green); border: 1px solid var(--rag-green); }
        .badge.normal { background: #e6f7ff; color: #1890ff; border: 1px solid #91d5ff; }

        /* Buttons */
        .btn { 
            padding: 6px 12px; border: 1px solid var(--border-color); background: white; 
            border-radius: var(--border-radius); cursor: pointer; font-size: 13px; 
            transition: all var(--anim-speed); display: inline-flex; align-items: center; gap: 6px;
        }
        .btn:hover { border-color: var(--primary-light); color: var(--primary-light); }
        .btn-primary { background: var(--primary); color: white; border-color: var(--primary); }
        .btn-primary:hover { background: var(--primary-light); color: white; }
        .btn-icon { padding: 6px; border: none; background: transparent; }

        /* Inputs */
        input, select { padding: 6px 10px; border: 1px solid var(--border-color); border-radius: var(--border-radius); font-size: 13px; width: 100%; }
        input:focus, select:focus { border-color: var(--primary); box-shadow: 0 0 0 2px var(--primary-bg); }

        /* -----------------------------------------------------------------------------
           3. LAYOUT COMPONENTS
           ----------------------------------------------------------------------------- */
        /* Sidebar */
        #sidebar {
            width: var(--sidebar-width);
            background: var(--bg-sidebar);
            color: rgba(255,255,255,0.65);
            display: flex;
            flex-direction: column;
            border-right: 1px solid #000;
            transition: width 0.2s;
            z-index: 10;
        }
        #sidebar .brand {
            height: var(--header-height);
            display: flex;
            align-items: center;
            padding: 0 20px;
            color: white;
            font-weight: 700;
            font-size: 16px;
            background: #002140;
            letter-spacing: 0.5px;
        }
        #sidebar .brand svg { margin-right: 10px; fill: white; width: 20px; }
        
        .nav-scroll { flex: 1; overflow-y: auto; padding: 12px 0; }
        .nav-group { margin-bottom: 12px; }
        .nav-header { padding: 0 24px; margin-bottom: 6px; font-size: 11px; text-transform: uppercase; color: rgba(255,255,255,0.35); font-weight: 600; letter-spacing: 0.5px; }
        
        .nav-item {
            padding: 10px 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: background 0.2s, color 0.2s;
            font-weight: 500;
        }
        .nav-item:hover { color: white; background: rgba(255,255,255,0.08); }
        .nav-item.active { background: var(--primary); color: white; }
        .nav-item svg { width: 16px; height: 16px; margin-right: 12px; opacity: 0.8; fill: currentColor; }

        /* Main Content */
        #main-wrapper { flex: 1; display: flex; flex-direction: column; overflow: hidden; background: #f0f2f5; }
        
        #header {
            height: var(--header-height);
            background: var(--bg-header);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            box-shadow: 0 1px 4px rgba(0,21,41,0.08);
            z-index: 5;
        }
        .breadcrumb { font-size: 13px; color: var(--text-secondary); }
        .breadcrumb span { color: var(--text-main); font-weight: 600; margin-left: 4px; }
        
        .user-menu { display: flex; align-items: center; gap: 16px; }
        .user-info { text-align: right; line-height: 1.2; }
        .user-name { font-weight: 600; color: var(--text-main); font-size: 13px; }
        .user-role { font-size: 11px; color: var(--text-muted); }
        .avatar { width: 32px; height: 32px; background: var(--primary-light); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; }

        #content-area { flex: 1; overflow-y: auto; padding: 24px; position: relative; }

        /* -----------------------------------------------------------------------------
           4. DATA VISUALIZATION & TABLES
           ----------------------------------------------------------------------------- */
        .card { background: white; border-radius: var(--border-radius); box-shadow: var(--shadow-card); margin-bottom: 24px; overflow: hidden; }
        .card-header { padding: 16px 24px; border-bottom: 1px solid var(--bg-body); display: flex; justify-content: space-between; align-items: center; font-weight: 600; font-size: 15px; }
        .card-body { padding: 24px; }
        .card-body.nopad { padding: 0; }

        /* Complex Table */
        .data-table-wrapper { overflow-x: auto; width: 100%; border: 1px solid var(--border-color); border-radius: 4px; }
        table.data-table { width: 100%; border-collapse: collapse; min-width: 1000px; }
        table.data-table th { 
            background: #fafafa; border-bottom: 1px solid var(--border-color); padding: 12px 16px; 
            text-align: left; font-weight: 600; color: var(--text-secondary); font-size: 12px; text-transform: uppercase;
            position: sticky; top: 0; z-index: 2;
        }
        table.data-table td { 
            padding: 12px 16px; border-bottom: 1px solid #f0f0f0; color: var(--text-main); font-size: 13px; 
            transition: background 0.2s;
        }
        table.data-table tr:hover td { background: #e6f7ff; cursor: pointer; }
        table.data-table tr.selected td { background: #e6f7ff; }

        /* Gantt / Timeline */
        .gantt-container { display: flex; height: 600px; border: 1px solid var(--border-color); background: white; }
        .gantt-sidebar { width: 300px; border-right: 1px solid var(--border-color); overflow-y: hidden; display: flex; flex-direction: column; }
        .gantt-timeline { flex: 1; overflow: auto; position: relative; cursor: grab; background: white; }
        .gantt-header-row { height: 40px; border-bottom: 1px solid var(--border-color); background: #fafafa; display: flex; align-items: center; padding-left: 12px; font-weight: 600; color: var(--text-secondary); }
        .gantt-row { height: 32px; border-bottom: 1px solid #f0f0f0; display: flex; align-items: center; padding-left: 12px; font-size: 12px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .gantt-bar-container { position: relative; height: 100%; }
        
        .gantt-bar { height: 18px; border-radius: 3px; position: absolute; top: 7px; cursor: pointer; box-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .gantt-bar:hover { filter: brightness(0.9); }
        .gantt-bar-label { position: absolute; left: 100%; margin-left: 8px; font-size: 10px; color: #666; top: 8px; white-space: nowrap; }

        /* Fever Chart (Buffer Mgmt) */
        .fever-chart-bg path { fill-opacity: 0.15; stroke: none; }
        .fever-zone-red { fill: #f5222d; }
        .fever-zone-yellow { fill: #fa8c16; }
        .fever-zone-green { fill: #52c41a; }
        .fever-point { stroke: white; stroke-width: 2px; r: 6px; cursor: pointer; transition: r 0.2s; }
        .fever-point:hover { r: 9px; }

        /* Loading Overlay */
        #loader { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.9); z-index: 999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s; pointer-events: none; opacity: 0; }
        #loader.active { opacity: 1; pointer-events: all; }
        .spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Modal */
        .modal-mask { position: fixed; inset: 0; background: rgba(0,0,0,0.45); z-index: 1000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(2px); }
        .modal-mask.open { display: flex; }
        .modal-wrapper { background: white; width: 800px; max-width: 90vw; border-radius: var(--border-radius); box-shadow: 0 4px 12px rgba(0,0,0,0.15); display: flex; flex-direction: column; max-height: 90vh; }
        .modal-header { padding: 16px 24px; border-bottom: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center; font-weight: 600; font-size: 16px; }
        .modal-body { padding: 24px; overflow-y: auto; }
        .modal-footer { padding: 16px 24px; border-top: 1px solid #f0f0f0; display: flex; justify-content: flex-end; gap: 12px; background: #fafafa; border-radius: 0 0 4px 4px; }

        /* Login Screen */
        #login-screen { position: fixed; inset: 0; background: #001529; z-index: 2000; display: flex; align-items: center; justify-content: center; background-image: linear-gradient(135deg, #001529 0%, #003a70 100%); }
        .login-box { background: white; width: 400px; padding: 40px; border-radius: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); text-align: center; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-box">
            <svg viewBox="0 0 24 24" width="64" height="64" fill="#0050b3" style="margin-bottom:20px;">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
            </svg>
            <h1 style="margin:0 0 10px 0; color:#002140; font-size:24px;">Streamliner</h1>
            <p style="color:#8c8c8c; margin-bottom:30px;">Enterprise Project Execution Platform</p>
            
            <div style="text-align:left; margin-bottom:15px;">
                <label style="font-size:12px; font-weight:600; color:#595959;">Username</label>
                <input type="text" id="login-user" value="sarthak.handa@ydgroup.com" style="padding:10px;">
            </div>
            <div style="text-align:left; margin-bottom:25px;">
                <label style="font-size:12px; font-weight:600; color:#595959;">Password</label>
                <input type="password" value="password123" style="padding:10px;">
            </div>
            <button class="btn btn-primary" style="width:100%; justify-content:center; padding:12px; font-size:14px;" onclick="App.auth.login()">
                Sign In to Workspace
            </button>
            <p style="margin-top:20px; font-size:11px; color:#bfbfbf;">Version 3.9.3 | Realization Technologies</p>
        </div>
    </div>

    <aside id="sidebar">
        <div class="brand">
            <svg viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
            REALIZATION
        </div>
        <div class="nav-scroll">
            <div class="nav-item active" onclick="App.router.go('dashboard2')">
                <svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
                Dashboard2
            </div>
            <div class="nav-item" onclick="App.router.go('projects1')">
                <svg viewBox="0 0 24 24"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>
                Projects1
            </div>
            <div class="nav-item" onclick="App.router.go('control-room')">
                <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"/></svg>
                Control Room
            </div>
            
            <div class="nav-group" style="margin-top:24px;">
                <div class="nav-header">Execution</div>
                <div class="nav-item"><svg viewBox="0 0 24 24"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"/><polyline points="13 2 13 9 20 9"/></svg> My View</div>
                <div class="nav-item"><svg viewBox="0 0 24 24"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg> Performance</div>
                <div class="nav-item"><svg viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg> Financials</div>
                <div class="nav-item"><svg viewBox="0 0 24 24"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg> Material</div>
            </div>

            <div class="nav-group">
                <div class="nav-header">Management</div>
                <div class="nav-item"><svg viewBox="0 0 24 24"><line x1="10" y1="12" x2="21" y2="12"/><line x1="10" y1="6" x2="21" y2="6"/><line x1="10" y1="18" x2="21" y2="18"/><circle cx="4" cy="12" r="2"/></svg> Task Mgmt</div>
                <div class="nav-item"><svg viewBox="0 0 24 24"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg> Issue Mgmt</div>
                <div class="nav-item"><svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/></svg> File Mgmt</div>
            </div>

            <div class="nav-group">
                <div class="nav-header">Administration</div>
                <div class="nav-item"><svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg> Manage Users</div>
                <div class="nav-item"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg> Config</div>
            </div>
        </div>
    </aside>

    <div id="main-wrapper">
        <header id="header">
            <div class="flex items-center gap-4">
                <div class="breadcrumb">Home / <span id="page-title">Dashboard2</span></div>
                <div class="badge normal">Division: DEFAULT</div>
            </div>
            <div class="user-menu">
                <div class="flex items-center gap-2">
                    <button class="btn btn-icon"><svg viewBox="0 0 24 24" width="18" height="18"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg></button>
                    <button class="btn btn-icon"><svg viewBox="0 0 24 24" width="18" height="18"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></button>
                </div>
                <div class="flex items-center gap-2 cursor-pointer">
                    <div class="user-info">
                        <div class="user-name">Sarthak Handa</div>
                        <div class="user-role">Analytics Engineer</div>
                    </div>
                    <div class="avatar">SH</div>
                </div>
            </div>
        </header>

        <div id="content-area">
            </div>
    </div>

    <div id="modal-container" class="modal-mask"></div>

    <div id="loader">
        <div class="spinner"></div>
        <div style="margin-top:16px; font-weight:600; color:#555;">Loading Project Data...</div>
    </div>

    <script>
        /**
         * STREAMLINER PROTOTYPE ENGINE
         * * Architecture:
         * 1. Store: Centralized state with massive seed data capability.
         * 2. Router: Handles view switching.
         * 3. Views: Render functions for Dashboard2, Projects1, Gantt, etc.
         * 4. Charts: Canvas/SVG drawing logic for Fever Charts and Gantt.
         */

        const Store = {
            state: {
                user: null,
                projects1: [],
                users: [],
                tasks: [],
                issues: []
            },

            init() {
                this.seedUsers();
                this.seedProjects1();
                console.log(`System Initialized: ${this.state.projects1.length} Projects1, ${this.state.tasks.length} Tasks.`);
            },

            seedUsers() {
                const names = [
                    "Aditya Saini", "Aditya Sharma", "Akshay Verma", "Anandhu Gopan", "Anil Yadav", 
                    "Aseem Gill", "Durga Prasad", "Gaurav Purohit", "Gulshan Kumar", "Krishna Pimpale", 
                    "Kuldeep Sharma", "Kunal Dagar", "Lokesh Chaudhary", "Mayank Bandha", "Neeraj Nautiyal",
                    "Sachin T", "Sanjay Kumar", "Saurabh Jangra", "Shivendu Sharma", "Vinit Jain"
                ];
                this.state.users = names.map((n, i) => ({
                    id: `u${i}`,
                    name: n,
                    email: n.toLowerCase().replace(' ', '.') + '@ydgroup.com',
                    velocity: Math.floor(Math.random() * 100)
                }));
            },

            seedProjects1() {
                const prefixes = ["N-2221", "N-2207", "N-2231", "N-2305", "N-2306", "N-2424", "N-2239", "N-2403", "N-2407", "N-2502"];
                const types = ["4HI CRM 400MM", "6HI CRM 1500 MM", "COLD ROLLING MILL", "CONTINUOUS GALVANIZING", "SKIN PASS MILL", "TRIMMER 1650MM", "PICKLING LINE", "REWINDING LINE"];
                const phases = ["Engineering", "Ordering", "Manufacturing", "Assembly", "Dispatch", "Erection", "Commissioning"];
                
                for (let i = 0; i < 60; i++) {
                    const id = `PRJ-${1000+i}`;
                    const manager = this.state.users[i % this.state.users.length];
                    const type = types[i % types.length];
                    const name = `${prefixes[i % prefixes.length]}-${type} ${1000 + (i*50)} MPM`;
                    
                    // Buffer Management Status (Critical Chain)
                    // Logic: % Complete vs % Buffer Consumed
                    const progress = Math.floor(Math.random() * 100);
                    const buffer = Math.floor(Math.random() * 100);
                    let status = 'Green';
                    if (buffer > progress + 20) status = 'Red'; // Consuming buffer faster than progress
                    else if (buffer > progress) status = 'Yellow';

                    const project = {
                        id,
                        code: name.split(' ')[0],
                        name: name,
                        dept: "DEFAULT",
                        workarea: i % 2 === 0 ? "Mill Housing" : "Assembly",
                        contractor: "DEFAULT",
                        manager: manager.name,
                        status: status, // RAG
                        progress: progress,
                        bufferConsumed: buffer,
                        startDate: new Date(2024, 0, 1 + (i*5)).toISOString().split('T')[0],
                        endDate: new Date(2025, 5, 30).toISOString().split('T')[0],
                        financials: {
                            budget: (Math.random() * 500).toFixed(2), // Crores
                            actual: (Math.random() * 200).toFixed(2)
                        }
                    };
                    
                    this.state.projects1.push(project);
                    this.seedTasks(project);
                }
            },

            seedTasks(project) {
                const cats = [
                    "BACKUP ROLL ASSY", "UNCOILER ASSY", "RECOILER ASSY", "WORK ROLL ASSY", 
                    "MILL DRIVE", "MILL HOUSING", "BED PLATE ASSY", "ROLL FORCE CYLINDER", 
                    "EXIT AIR KNIFE", "COIL CAR ASSY", "PEELER TABLE", "HYDRAULIC POWER PACK"
                ];
                
                cats.forEach((cat, idx) => {
                    const duration = Math.floor(Math.random() * 40) + 10;
                    const startOffset = idx * 15;
                    const startDate = new Date(project.startDate);
                    startDate.setDate(startDate.getDate() + startOffset);
                    
                    const endDate = new Date(startDate);
                    endDate.setDate(endDate.getDate() + duration);

                    this.state.tasks.push({
                        id: `${project.id}-T${idx}`,
                        projectId: project.id,
                        name: `Category ${idx+1}-${cat} - Ordering & Manufacturing`,
                        phase: "Manufacturing",
                        start: startDate,
                        end: endDate,
                        duration: duration,
                        progress: Math.random() > 0.5 ? Math.floor(Math.random() * 100) : 0,
                        status: Math.random() > 0.8 ? 'Stuck' : 'IP',
                        assignee: project.manager
                    });
                });
            }
        };

        const App = {
            auth: {
                login() {
                    document.getElementById('login-screen').style.display = 'none';
                    App.router.go('dashboard2');
                }
            },
            router: {
                go(route, params) {
                    // Update Active Nav
                    document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
                    // Simple heuristic for nav highlighting
                    const navs = document.querySelectorAll('.nav-item');
                    if(route === 'dashboard2') navs[0].classList.add('active');
                    if(route === 'projects1') navs[1].classList.add('active');
                    
                    document.getElementById('loader').classList.add('active');
                    
                    setTimeout(() => {
                        const content = document.getElementById('content-area');
                        const title = document.getElementById('page-title');
                        
                        if (route === 'dashboard2') {
                            title.innerText = 'Dashboard2';
                            content.innerHTML = Views.dashboard2();
                            Charts.renderVelocity('chart-velocity');
                        } else if (route === 'projects1') {
                            title.innerText = 'Project Control Room';
                            content.innerHTML = Views.projectList();
                        } else if (route === 'gantt') {
                            title.innerText = `Timeline: ${params.name}`;
                            content.innerHTML = Views.gantt(params);
                            Charts.renderGantt('gantt-canvas', params.id);
                        } else {
                            content.innerHTML = `<div class="p-4">Module under construction</div>`;
                        }
                        
                        document.getElementById('loader').classList.remove('active');
                    }, 400); // Fake network delay
                }
            }
        };

        const Views = {
            dashboard2() {
                const topUsers = Store.state.users.sort((a,b) => b.velocity - a.velocity).slice(0, 5);
                const bottomUsers = Store.state.users.sort((a,b) => a.velocity - b.velocity).slice(0, 5);

                return `
                    <div class="flex gap-4 mb-4">
                        <div class="card grow">
                            <div class="card-header">Overall Velocity Trend</div>
                            <div class="card-body">
                                <div id="chart-velocity" style="height:250px; width:100%;"></div>
                            </div>
                        </div>
                        <div class="card" style="width: 350px;">
                            <div class="card-header">Division Status</div>
                            <div class="card-body nopad">
                                <table class="data-table">
                                    <thead><tr><th>Division</th><th>Velocity</th></tr></thead>
                                    <tbody>
                                        <tr><td>DEFAULT</td><td><span class="text-bold" style="color:red">24%</span></td></tr>
                                        <tr><td>SPARES</td><td><span class="text-bold" style="color:orange">56%</span></td></tr>
                                        <tr><td>TEST PROJ</td><td><span class="text-bold" style="color:green">59%</span></td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="flex gap-4">
                        <div class="card grow">
                            <div class="card-header">Top 5 Performers (Velocity)</div>
                            <div class="card-body nopad">
                                <table class="data-table">
                                    <thead><tr><th>Name</th><th>Velocity</th><th>Trend</th></tr></thead>
                                    <tbody>
                                        ${topUsers.map(u => `
                                            <tr>
                                                <td>${u.name}</td>
                                                <td><span class="badge ontrack">${u.velocity}%</span></td>
                                                <td><span style="color:green">▲</span></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="card grow">
                            <div class="card-header">Bottom 5 Performers</div>
                            <div class="card-body nopad">
                                <table class="data-table">
                                    <thead><tr><th>Name</th><th>Velocity</th><th>Trend</th></tr></thead>
                                    <tbody>
                                        ${bottomUsers.map(u => `
                                            <tr>
                                                <td>${u.name}</td>
                                                <td><span class="badge critical">${u.velocity}%</span></td>
                                                <td><span style="color:red">▼</span></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
            },

            projectList() {
                const projects1 = Store.state.projects1;
                return `
                    <div class="card">
                        <div class="card-header">
                            <div>Master Project Registry</div>
                            <div class="flex gap-2">
                                <input type="text" placeholder="Search projects1..." style="width:200px;">
                                <button class="btn btn-primary">+ Create Project</button>
                            </div>
                        </div>
                        <div class="card-body nopad data-table-wrapper">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Status</th>
                                        <th>Project Name</th>
                                        <th>Department</th>
                                        <th>Manager</th>
                                        <th>Start Date</th>
                                        <th>Proj. End</th>
                                        <th>Buffer Consumption</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${projects1.map(p => {
                                        const badgeClass = p.status === 'Red' ? 'critical' : (p.status === 'Yellow' ? 'warning' : 'ontrack');
                                        // Simple Fever Chart Logic visual
                                        const feverColor = p.status === 'Red' ? '#f5222d' : (p.status === 'Yellow' ? '#fa8c16' : '#52c41a');
                                        return `
                                            <tr onclick='App.router.go("gantt", ${JSON.stringify(p)})'>
                                                <td><span class="badge ${badgeClass}">${p.status.toUpperCase()}</span></td>
                                                <td class="text-bold" style="color:#0050b3">${p.name}</td>
                                                <td>${p.dept}</td>
                                                <td>${p.manager}</td>
                                                <td>${p.startDate}</td>
                                                <td>${p.endDate}</td>
                                                <td style="width:150px;">
                                                    <div style="font-size:10px; margin-bottom:2px; display:flex; justify-content:space-between;">
                                                        <span>${p.progress}% Done</span>
                                                        <span>${p.bufferConsumed}% Buffer</span>
                                                    </div>
                                                    <div style="height:6px; background:#f0f0f0; border-radius:3px; position:relative; overflow:hidden;">
                                                        <div style="position:absolute; left:0; width:${p.progress}%; background:#1890ff; height:100%; z-index:1;"></div>
                                                        <div style="position:absolute; left:0; width:${p.bufferConsumed}%; background:${feverColor}; height:100%; opacity:0.5; z-index:0;"></div>
                                                    </div>
                                                </td>
                                                <td><button class="btn">View</button></td>
                                            </tr>
                                        `;
                                    }).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            },

            gantt(project) {
                return `
                    <div class="flex gap-4 mb-4">
                        <div class="card" style="width:300px;">
                            <div class="card-header">Buffer Management</div>
                            <div class="card-body flex justify-center">
                                <svg width="200" height="150" viewBox="0 0 200 150" style="border:1px solid #eee;">
                                    <path d="M0 150 L200 150 L200 0 L0 0 Z" fill="#f6ffed" /> <path d="M0 150 L200 100 L200 0 L0 0 Z" fill="#fff7e6" /> <path d="M0 150 L200 50 L200 0 L0 0 Z" fill="#fff1f0" /> <line x1="0" y1="150" x2="200" y2="150" stroke="#ccc" stroke-width="2"/>
                                    <line x1="0" y1="0" x2="0" y2="150" stroke="#ccc" stroke-width="2"/>
                                    
                                    <circle cx="${(project.progress/100)*200}" cy="${150 - ((project.bufferConsumed/100)*150)}" r="6" fill="#333" stroke="white" stroke-width="2" class="fever-point">
                                        <title>Current Status: ${project.progress}% Complete, ${project.bufferConsumed}% Buffer Used</title>
                                    </circle>
                                    <text x="100" y="145" text-anchor="middle" font-size="10" fill="#666">% Chain Completed</text>
                                    <text x="10" y="75" transform="rotate(-90 10,75)" text-anchor="middle" font-size="10" fill="#666">% Buffer Consumed</text>
                                </svg>
                            </div>
                        </div>
                        <div class="card grow">
                            <div class="card-header">
                                <div>Project Details: ${project.code}</div>
                                <div class="flex gap-2">
                                    <span class="badge normal">Budget: ${project.financials.budget} Cr</span>
                                    <span class="badge normal">Actual: ${project.financials.actual} Cr</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="flex justify-between mb-4">
                                    <div>
                                        <div class="text-secondary" style="font-size:11px;">MANAGER</div>
                                        <div class="text-bold">${project.manager}</div>
                                    </div>
                                    <div>
                                        <div class="text-secondary" style="font-size:11px;">START DATE</div>
                                        <div class="text-bold">${project.startDate}</div>
                                    </div>
                                    <div>
                                        <div class="text-secondary" style="font-size:11px;">PROJECTED END</div>
                                        <div class="text-bold text-right" style="color:#f5222d">${project.endDate}</div>
                                    </div>
                                </div>
                                <button class="btn btn-primary" onclick="alert('Simulated Check-Out for Editing')">Check Out Project</button>
                            </div>
                        </div>
                    </div>

                    <div class="card grow">
                        <div class="card-header">
                            <div>Execution Schedule (Critical Chain)</div>
                            <div class="flex gap-2">
                                <button class="btn btn-icon">-</button>
                                <button class="btn btn-icon">+</button>
                            </div>
                        </div>
                        <div class="card-body nopad">
                            <div class="gantt-container">
                                <div class="gantt-sidebar" id="gantt-sidebar-content">
                                    <div class="gantt-header-row">Task Name</div>
                                    </div>
                                <div class="gantt-timeline" id="gantt-timeline-content">
                                    <div style="width: 2000px; height: 100%; position: relative;" id="gantt-canvas">
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
        };

        const Charts = {
            renderVelocity(id) {
                // Simple SVG Line Chart simulation
                const el = document.getElementById(id);
                if(!el) return;
                
                const w = el.clientWidth;
                const h = 250;
                const points = [20, 35, 45, 40, 55, 60, 75, 80, 85, 90, 88, 95]; // Sample data
                const step = w / (points.length - 1);
                
                let svg = `<svg width="100%" height="100%" viewBox="0 0 ${w} ${h}">`;
                
                // Grid
                for(let i=0; i<5; i++) {
                    svg += `<line x1="0" y1="${i*(h/4)}" x2="${w}" y2="${i*(h/4)}" stroke="#f0f0f0" />`;
                }

                // Line
                let path = `M 0 ${h - (points[0]/100)*h}`;
                points.forEach((p, i) => {
                    path += ` L ${i*step} ${h - (p/100)*h}`;
                });
                svg += `<path d="${path}" fill="none" stroke="#1890ff" stroke-width="3" />`;
                
                // Area
                svg += `<path d="${path} L ${w} ${h} L 0 ${h} Z" fill="rgba(24,144,255,0.1)" stroke="none" />`;

                // Points
                points.forEach((p, i) => {
                    svg += `<circle cx="${i*step}" cy="${h - (p/100)*h}" r="4" fill="white" stroke="#1890ff" stroke-width="2" />`;
                });

                svg += `</svg>`;
                el.innerHTML = svg;
            },

            renderGantt(containerId, projectId) {
                const tasks = Store.state.tasks.filter(t => t.projectId === projectId);
                const sidebar = document.getElementById('gantt-sidebar-content');
                const canvas = document.getElementById('gantt-canvas');
                
                let sidebarHtml = '<div class="gantt-header-row">Task Name</div>';
                let canvasHtml = '';
                
                // Time Scale (Months)
                let headerHtml = '<div style="display:flex; height:40px; border-bottom:1px solid #eee; background:#fafafa;">';
                for(let i=0; i<24; i++) {
                    headerHtml += `<div style="width:100px; flex-shrink:0; border-right:1px solid #eee; padding:10px; font-size:11px; font-weight:600;">Month ${i+1}</div>`;
                }
                headerHtml += '</div>';
                canvasHtml += headerHtml;

                // Task Rows
                tasks.forEach((t, i) => {
                    sidebarHtml += `<div class="gantt-row" style="top:${40 + (i*32)}px">${t.name}</div>`;
                    
                    // Calculate position based on date (mock)
                    const dayPixel = 3; // 3px per day
                    const startDiff = (new Date(t.start) - new Date(tasks[0].start)) / (1000 * 60 * 60 * 24);
                    const left = Math.max(0, startDiff * dayPixel);
                    const width = t.duration * dayPixel;
                    const color = t.status === 'Stuck' ? '#ff4d4f' : (t.progress === 100 ? '#52c41a' : '#1890ff');

                    canvasHtml += `
                        <div style="height:32px; border-bottom:1px solid #f9f9f9; position:relative;">
                            <div class="gantt-bar" style="left:${left}px; width:${width}px; background:${color};" title="${t.name}"></div>
                            <div class="gantt-bar-label" style="left:${left+width}px;">${t.progress}%</div>
                        </div>
                    `;
                });

                sidebar.innerHTML = sidebarHtml;
                canvas.innerHTML = canvasHtml;
            }
        };

        // Initialize App
        Store.init();

        // For demo purposes, if user is not logged in, show login.
        // If we want to skip login for dev, we can call App.router.go('dashboard2') directly.
        // App.router.go('dashboard2'); 

    </script>
</body>
</html>